<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script src="//www.google.com/jsapi"></script>
    <script>window.parent.maeExportApis_();</script>
  </head>
  <body>  
    <ul>
    <ol>
      <?
      var sheet = SpreadsheetApp.getActiveSheet();
      var LastRow = sheet.getRange("A1:A").getLastRow();
      var last_number = calculateLastRow_down(sheet, LastRow, 1) - 1; 
      var data = sheet.getRange("B1:B").getValues();
      
      for(var i=1;i<last_number;i++){
        //output.append('<p><button onclick="go_DetailPage(' + i + ')">企画'+ i +'</button></p>');
        output.append('<li><p><button onclick="go_DetailPage(' + i + ')">'+data[i][0]+'</button></p></li>');
      }
      ?>
      <!--
      <p><button onclick="go_DetailPage(1)">企画1</button></p>
      <p><button onclick="go_DetailPage(2)">企画2</button></p>
      <p><button onclick="go_DetailPage(3)">企画3</button></p>
      <p><button onclick="go_DetailPage(4)">企画4</button></p>
      <p><button onclick="go_DetailPage(5)">企画5</button></p>
      -->
    </ol>
    </ul>

    <p><button onclick="go_newpage('True')">+ add new plan</button></p>
    
  <script>
    function go_newpage(botton) {
      google.script.run.insertNewInfo('True')
      window.top.location.href = "https://sites.google.com/view/ra-chin-main/home/plan"
    }
    function go_DetailPage(number) {
      google.script.run.updateRecord(number)
      window.top.location.href = "https://sites.google.com/view/ra-chin-main/home/plan/plan_detail"
    }
  </script>
  
  </body>
  <script>
    function go_newpage(botton) {
      google.script.run.insertNewInfo('True')
      window.top.location.href = "https://sites.google.com/view/ra-chin-main/home/plan"
    }
    function go_DetailPage(number) {
      google.script.run.updateRecord(number)
      window.top.location.href = "https://sites.google.com/view/ra-chin-main/home/plan/plan_detail"
    }
  </script>
</html>